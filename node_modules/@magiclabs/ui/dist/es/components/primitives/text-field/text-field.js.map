{"version":3,"file":"text-field.js","sources":["../../../../../src/components/primitives/text-field/text-field.tsx"],"sourcesContent":["import composeRefs from '@seznam/compose-react-refs';\nimport { AnimatePresence, motion } from 'framer-motion';\nimport React, { useCallback, useEffect, useRef, useState } from 'react';\nimport { useFocus, useFocusRing, useFocusVisible, useFocusWithin } from 'react-aria';\nimport { transitions } from '../../../hooks/transitions';\nimport { clsx } from '../../../libs/clsx';\nimport { forwardRefWrapper } from '../../../libs/forward-ref-wrapper';\nimport { mergeProps } from '../../../libs/merge-props';\nimport { IntrinsicElementProps } from '../../../types/utility';\nimport { Icon, MonochromeIcons } from '../../icons';\nimport { Flex, Outset } from '../../layout';\nimport { useTheme } from '../../theme-provider';\n\nimport styles from './text-field.less';\n\ninterface TextFieldProps extends Omit<IntrinsicElementProps<'input'>, 'size' | 'prefix'> {\n  disabled?: boolean;\n  label?: string;\n  errorMessage?: string;\n  validateOnBlur?: boolean;\n  size?: 'sm' | 'md' | 'lg';\n  prefix?: React.ReactNode;\n  suffix?: React.ReactNode;\n  addonBefore?: React.ReactNode;\n  addonAfter?: React.ReactNode;\n}\n\nconst TextFieldRender = /* @__PURE__ */ forwardRefWrapper<HTMLInputElement, TextFieldProps>(\n  'TextField',\n\n  { size: 'md' },\n\n  (props, externalRef) => {\n    const {\n      id,\n      required,\n      disabled,\n      label,\n      placeholder,\n      errorMessage,\n      validateOnBlur,\n      size,\n      prefix,\n      suffix,\n      addonBefore,\n      addonAfter,\n      ...otherProps\n    } = props;\n\n    const [hasError, setHasError] = useState(!!errorMessage);\n\n    useEffect(() => {\n      setHasError(!!errorMessage);\n    }, [errorMessage]);\n\n    const onBlur = useCallback<React.FocusEventHandler<HTMLInputElement>>(\n      (e) => {\n        if (validateOnBlur) {\n          const valid = e.target.checkValidity();\n          setHasError(!valid || !!errorMessage);\n        }\n      },\n      [errorMessage],\n    );\n\n    // Focus\n    const [isFocused, onFocusChange] = useState(false);\n    const [isFocusedWithinAddonBefore, onFocusWithinAddonBeforeChange] = useState(false);\n    const [isFocusedWithinAddonAfter, onFocusWithinAddonAfterChange] = useState(false);\n    const { focusProps } = useFocus({ isDisabled: disabled, onBlur, onFocusChange });\n    const { focusWithinProps: focusWithinAddonBeforeProps } = useFocusWithin({\n      isDisabled: disabled,\n      onFocusWithinChange: onFocusWithinAddonBeforeChange,\n    });\n    const { focusWithinProps: focusWithinAddonAfterProps } = useFocusWithin({\n      isDisabled: disabled,\n      onFocusWithinChange: onFocusWithinAddonAfterChange,\n    });\n    const { isFocusVisible } = useFocusVisible({ isTextInput: true });\n\n    const inputRef = useRef<HTMLInputElement | null>(null);\n    const focusOnInput = useCallback(() => {\n      if (inputRef.current) inputRef.current.focus();\n    }, [inputRef]);\n\n    const getScaleProps = transitions.useScale();\n    const theme = useTheme();\n\n    return (\n      <Flex.Column>\n        {label && (\n          <Outset bottom={8}>\n            <label htmlFor={id} className={clsx([styles.TextFieldLabel, styles[`size_${size}`]])}>\n              <Flex.Row alignItems=\"center\">\n                <Outset right={3} trim=\"horizontal\">\n                  <span>{label}</span>\n                  {required && <Icon size={10} color={theme.hex.error.darker} type={MonochromeIcons.AsteriskBold} />}\n                </Outset>\n              </Flex.Row>\n            </label>\n          </Outset>\n        )}\n\n        <Flex.Row\n          alignItems=\"center\"\n          onClick={focusOnInput}\n          className={clsx([\n            styles.TextField,\n            disabled && styles.disabled,\n            isFocused && styles.focus,\n            (isFocusedWithinAddonBefore || isFocusedWithinAddonAfter) && isFocusVisible && styles.focusWithin,\n            isFocusedWithinAddonBefore && isFocusVisible && styles.focusWithinAddonBefore,\n            isFocusedWithinAddonAfter && isFocusVisible && styles.focusWithinAddonAfter,\n            hasError && styles.hasError,\n          ])}\n        >\n          {addonBefore && (\n            <Flex.Item\n              {...focusWithinAddonBeforeProps}\n              shrink={0}\n              alignSelf=\"stretch\"\n              className={clsx(styles.addon, styles.before)}\n            >\n              {addonBefore}\n            </Flex.Item>\n          )}\n\n          <Flex.Row grow={1} alignItems=\"center\" className={clsx(styles.paddingContainer, styles[`size_${size}`])}>\n            <AnimatePresence initial={false} mode=\"wait\">\n              {prefix && (\n                <motion.div className={styles.prefix} {...getScaleProps(0.7)} key={0}>\n                  {prefix}\n                </motion.div>\n              )}\n            </AnimatePresence>\n\n            <input\n              {...mergeProps(\n                {\n                  id,\n                  tabIndex: disabled ? -1 : 0,\n                  disabled,\n                  'aria-label': !label && !!placeholder ? placeholder : undefined,\n                  placeholder,\n                },\n                focusProps,\n                otherProps,\n              )}\n              ref={composeRefs(inputRef, externalRef)}\n            />\n\n            <AnimatePresence initial={false} mode=\"wait\">\n              {suffix && !hasError && (\n                <motion.div className={styles.suffix} {...getScaleProps(0.7)} key={0}>\n                  {suffix}\n                </motion.div>\n              )}\n            </AnimatePresence>\n          </Flex.Row>\n\n          {addonAfter && (\n            <Flex.Item\n              {...focusWithinAddonAfterProps}\n              shrink={0}\n              alignSelf=\"stretch\"\n              className={clsx(styles.addon, styles.after)}\n            >\n              {addonAfter}\n            </Flex.Item>\n          )}\n        </Flex.Row>\n\n        {errorMessage && (\n          <Outset top={8} left={0}>\n            <span className={clsx([styles.TextFieldErrorMessage, styles[`size_${size}`]])}>{errorMessage}</span>\n          </Outset>\n        )}\n      </Flex.Column>\n    );\n  },\n);\n\nconst TextFieldAddonButton = /* @__PURE__ */ forwardRefWrapper<HTMLButtonElement, IntrinsicElementProps<'button'>>(\n  'TextField.AddonButton',\n\n  (props, externalRef) => {\n    const { disabled, autoFocus, children, ...otherProps } = props;\n    const { isFocusVisible, focusProps } = useFocusRing({ autoFocus });\n\n    return (\n      <Flex.Row vertical=\"center\" horizontal=\"center\" className={styles.AddonButton}>\n        {/* eslint-disable-next-line react/button-has-type */}\n        <button\n          {...mergeProps(\n            {\n              className: clsx(disabled && styles.disabled, isFocusVisible && styles.focus),\n              disabled,\n              autoFocus,\n            },\n            focusProps,\n            otherProps,\n          )}\n          ref={externalRef}\n        >\n          {children}\n        </button>\n      </Flex.Row>\n    );\n  },\n);\n\nexport const TextField = /* @__PURE__ */ Object.assign(TextFieldRender, {\n  AddonButton: TextFieldAddonButton,\n});\n"],"names":["styles","MonochromeIcons.AsteriskBold"],"mappings":"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"}