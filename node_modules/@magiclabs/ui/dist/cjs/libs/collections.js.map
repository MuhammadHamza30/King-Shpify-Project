{"version":3,"file":"collections.js","sources":["../../../src/libs/collections.tsx"],"sourcesContent":["import type { PartialNode } from '@react-stately/collections';\nimport type { CollectionBase, CollectionChildren, ItemProps, SectionProps } from '@react-types/shared';\nimport React, { ReactElement } from 'react';\nimport { createErrorWithCode, logWarning } from './exceptions';\nimport { createGenericComponent } from './generic-component';\n\nfunction ItemRender<T>(props: ItemProps<T>) {\n  return null as any;\n}\n\n(ItemRender as any).getCollectionNode = function* getCollectionNode<T>(\n  props: ItemProps<T>,\n  context: any,\n): Generator<PartialNode<T>> {\n  const { childItems, title, children } = props;\n\n  const rendered = props.title || props.children;\n  const textValue = props.textValue || (typeof rendered === 'string' ? rendered : '') || props['aria-label'] || '';\n\n  if (!textValue && !context?.suppressTextValueWarning) {\n    logWarning(\n      `<Item>`,\n      'Non-plain text contents is unsupported by type-to-select for accessibility. Please add a `textValue` prop.',\n    );\n  }\n\n  yield {\n    type: 'item',\n    props,\n    rendered,\n    textValue,\n    'aria-label': props['aria-label'],\n    hasChildNodes: hasChildItems(props),\n    *childNodes() {\n      if (childItems) {\n        for (const child of childItems) {\n          yield {\n            type: 'item',\n            value: child,\n          };\n        }\n      } else if (title) {\n        const items: PartialNode<T>[] = [];\n        React.Children.forEach(children, (child) => {\n          items.push({\n            type: 'item',\n            element: child as ReactElement,\n          });\n        });\n\n        yield* items;\n      }\n    },\n  };\n};\n\nexport const Item = /* @__PURE__ */ createGenericComponent('Item', ItemRender);\n\nfunction SectionRender<T>(props: SectionProps<T>) {\n  return null as any;\n}\n\n(SectionRender as any).getCollectionNode = function* getCollectionNode<T>(\n  props: SectionProps<T>,\n): Generator<PartialNode<T>> {\n  const { children, title, items } = props;\n  yield {\n    type: 'section',\n    hasChildNodes: true,\n    rendered: title,\n    'aria-label': props['aria-label'],\n    *childNodes() {\n      if (typeof children === 'function') {\n        if (!items) {\n          throw createErrorWithCode(\n            'INVALID_COLLECTION_FACTORY_WITHOUT_ITEMS',\n            `<Section>`,\n            '`props.children` is a function but `props.items` is missing.',\n          );\n        }\n\n        for (const item of items) {\n          yield {\n            type: 'item',\n            value: item,\n            renderer: children,\n          };\n        }\n      } else {\n        // eslint-disable-next-line no-shadow\n        const items: PartialNode<T>[] = [];\n        React.Children.forEach(children, (child) => {\n          items.push({\n            type: 'item',\n            element: child,\n          });\n        });\n\n        yield* items;\n      }\n    },\n  };\n};\n\nexport const Section = /* @__PURE__ */ createGenericComponent('Section', SectionRender);\n\nfunction hasChildItems<T>(props: ItemProps<T>) {\n  if (props.hasChildItems != null) {\n    return props.hasChildItems;\n  }\n\n  if (props.childItems) {\n    return true;\n  }\n\n  if (props.title && React.Children.count(props.children) > 0) {\n    return true;\n  }\n\n  return false;\n}\n\nfunction isValidCollectionChild(source: string | React.FC, child?: JSX.Element): void {\n  if (React.isValidElement(child) && !!(child.type as any).getCollectionNode) return;\n\n  throw createErrorWithCode(\n    'INVALID_COLLECTION_INCOMPATIBLE_CHILDREN_DETECTED',\n    source,\n    'Only children wrapped with <Item> or <Section> are allowed.',\n  );\n}\n\n/**\n * Performs arbitrary validations upon on a list of `CollectionChildren`. We use\n * this to white-label error messages related to `@react-stately/collections`.\n *\n * Returns a replacement list of `CollectionChildren` with the validations\n * applied. The return value from this function can be given directly to\n * collection-based hooks/components from `@react-stately/collections`.\n */\nexport function validateCollection<T>(\n  props: Partial<CollectionBase<T>>,\n  source: string | React.FC<any>,\n): CollectionChildren<T> {\n  const { children, items } = props;\n\n  if (typeof children !== 'function') {\n    React.Children.forEach(children, (child) => {\n      isValidCollectionChild(source, child);\n    });\n\n    return children!;\n  }\n\n  if (!items) {\n    throw createErrorWithCode(\n      'INVALID_COLLECTION_FACTORY_WITHOUT_ITEMS',\n      source,\n      '`props.children` is a function but `props.items` is missing.',\n    );\n  }\n\n  return (...args: any[]) => {\n    const element = (children as any)?.(...args);\n\n    const key = element.key ?? element.id;\n    if (key == null) {\n      throw createErrorWithCode('INVALID_COLLECTION_MISSING_KEY', source, 'No key found for item.');\n    }\n\n    isValidCollectionChild(source, element);\n    return element;\n  };\n}\n"],"names":["logWarning","React","createGenericComponent","createErrorWithCode"],"mappings":"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"}