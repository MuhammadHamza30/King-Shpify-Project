{"version":3,"file":"tab.js","sources":["../../../../../../src/components/layout/tabs/tab/tab.tsx"],"sourcesContent":["import composeRefs from '@seznam/compose-react-refs';\nimport React, { useCallback, useEffect, useRef } from 'react';\nimport { useHover } from 'react-aria';\nimport { useInitialRender } from 'usable-react';\nimport { useTheme } from '../../../theme-provider';\nimport { clsx } from '../../../../libs/clsx';\nimport { forwardRefWrapper } from '../../../../libs/forward-ref-wrapper';\nimport { Icon, IconColorProvider, MonochromeIconDefinition } from '../../../icons';\nimport { mergeProps } from '../../../../libs/merge-props';\nimport { IntrinsicElementProps } from '../../../../types/utility';\nimport { Spacer } from '../../spacer';\n\nimport styles from './tab.less';\n\ninterface TabProps extends IntrinsicElementProps<'button'> {\n  id: string;\n  panelID: string;\n  allTabIDs: string[];\n  index: number;\n  activateTab: (tabID: string) => void;\n  selected: boolean;\n  orientation: 'horizontal' | 'vertical';\n  size: 'sm' | 'md' | 'lg';\n  useAnimation: boolean;\n  icon?: MonochromeIconDefinition;\n}\n\nfunction getPrevTabID(tabIDs: string[], index: number) {\n  const maxIndex = tabIDs.length - 1;\n  const nextIndex = index <= 0 ? maxIndex : index - 1;\n  return tabIDs[nextIndex];\n}\n\nfunction getNextTabID(tabIDs: string[], index: number) {\n  const maxIndex = tabIDs.length - 1;\n  const nextIndex = index >= maxIndex ? 0 : index + 1;\n  return tabIDs[nextIndex];\n}\n\n/**\n * Determines a _default_ color for icons nested in a `<Tab>`.\n */\nfunction useIconColor(\n  orientation: TabProps['orientation'],\n  isHovered?: boolean,\n  isSelected?: boolean,\n): string | undefined {\n  const theme = useTheme();\n\n  if (orientation === 'horizontal') {\n    if (isHovered && !isSelected) return theme.hex.primary.darker;\n    if (isSelected) return theme.hex.secondary.base;\n    return theme.hex.tertiary.base;\n  }\n\n  return theme.hex.tertiary.base;\n}\n\nexport const Tab = /* @__PURE__ */ forwardRefWrapper<HTMLButtonElement, TabProps>('Tab', (props, externalRef) => {\n  const {\n    id,\n    panelID,\n    allTabIDs,\n    index,\n    activateTab,\n    selected,\n    orientation,\n    size,\n    useAnimation,\n    icon,\n    children,\n  } = props;\n\n  const ref = useRef<HTMLButtonElement | null>(null);\n\n  const isInitialRender = useInitialRender();\n\n  useEffect(() => {\n    // We purposely don't add this value to the dependency array because we only\n    // want to trigger this effect upon the first user interaction (via\n    // mouseclick or keydown).\n    if (isInitialRender) return;\n\n    // If the current tab is selected, give it focus\n    if (selected && ref.current) ref.current.focus();\n  }, [selected]);\n\n  const handleClick = useCallback<React.EventHandler<React.MouseEvent<HTMLButtonElement>>>(\n    (e) => {\n      e.preventDefault();\n      activateTab(id);\n    },\n\n    [id],\n  );\n\n  const handleKeyDown = useCallback<React.EventHandler<React.KeyboardEvent<HTMLButtonElement>>>(\n    (e) => {\n      const prevTabID = getPrevTabID(allTabIDs, index);\n      const nextTabID = getNextTabID(allTabIDs, index);\n\n      const handleTabChange = (tabID: string) => {\n        e.preventDefault();\n        activateTab(tabID);\n      };\n\n      const handleArrowKey = (assertOrientation: typeof orientation, tabID: string) => {\n        if (orientation === assertOrientation) {\n          handleTabChange(tabID);\n        }\n      };\n\n      switch (e.key) {\n        case 'ArrowRight':\n          handleArrowKey('horizontal', nextTabID);\n          break;\n\n        case 'ArrowLeft':\n          handleArrowKey('horizontal', prevTabID);\n          break;\n\n        case 'ArrowUp':\n          handleArrowKey('vertical', prevTabID);\n          break;\n\n        case 'ArrowDown':\n          handleArrowKey('vertical', nextTabID);\n          break;\n\n        case 'Home':\n          handleTabChange(allTabIDs[0]);\n          break;\n\n        case 'End':\n          handleTabChange(allTabIDs[allTabIDs.length - 1]);\n          break;\n\n        case 'Delete': // We currently don't handle the 'Delete' case...\n        default:\n          break;\n      }\n    },\n\n    [allTabIDs, index, orientation],\n  );\n\n  const { isHovered, hoverProps } = useHover({ isDisabled: false });\n  const iconColor = useIconColor(orientation, isHovered, selected);\n\n  return (\n    <IconColorProvider colorA={iconColor}>\n      <button\n        className={clsx([\n          styles.Tab,\n          styles[`size_${size}`],\n          selected && styles.selected,\n          styles[orientation],\n          useAnimation && styles.withAnimation,\n        ])}\n        id={id}\n        type=\"button\"\n        role=\"tab\"\n        aria-selected={selected}\n        aria-controls={panelID}\n        tabIndex={selected ? 0 : -1}\n        {...mergeProps(hoverProps, {\n          onClick: handleClick,\n          onKeyDown: handleKeyDown,\n        })}\n        ref={composeRefs(ref, externalRef)}\n      >\n        {icon && (\n          <>\n            <Icon className={styles.icon} size={size === 'sm' ? 20 : 24} type={icon} />\n            <Spacer size={8} />\n          </>\n        )}\n\n        {children}\n      </button>\n    </IconColorProvider>\n  );\n});\n"],"names":["useTheme","forwardRefWrapper","useRef","useInitialRender","useEffect","useCallback","useHover","React","IconColorProvider","clsx","styles","mergeProps","composeRefs","Icon","Spacer"],"mappings":"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"}