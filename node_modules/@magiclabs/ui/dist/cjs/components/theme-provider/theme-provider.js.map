{"version":3,"file":"theme-provider.js","sources":["../../../../src/components/theme-provider/theme-provider.tsx"],"sourcesContent":["import React, { PropsWithChildren, useContext, useMemo } from 'react';\nimport { useIsomorphicLayoutEffect } from '../../hooks/use-isomorphic-layout-effect';\nimport { clsx } from '../../libs/clsx';\nimport { DEFAULT_THEME } from '../../libs/theme/default-theme';\nimport { Theme } from '../../libs/theme/theme-types';\nimport { getThemeVariables } from '../../libs/theme/theme-variables';\nimport { Announcer } from '../feedback/announcer';\nimport { MediaProvider } from './media-provider';\nimport { ThemeContext } from './use-theme';\n\ninterface ThemeProviderProps extends PropsWithChildren {\n  theme?: Theme;\n}\n\nexport const ThemeProvider: React.FC<ThemeProviderProps> = (props) => {\n  const { theme = DEFAULT_THEME, children } = props;\n  const isRoot = !useContext(ThemeContext).theme;\n  const { variables, applyToDocument } = getThemeVariables(theme);\n\n  useIsomorphicLayoutEffect(() => {\n    if (isRoot) applyToDocument();\n  }, [theme.key, isRoot]);\n\n  const themeVariablesMemoized = useMemo(() => variables, [theme.key]);\n  const themeMetadata = clsx([theme.isDarkTheme ? 'dark' : 'light', theme.isLowContrast && 'lowContrast']);\n  const themeCtx: ThemeContext = useMemo(() => ({ theme }), [theme.key]);\n\n  /*\n\n    NOTES\n    ~~~~~\n\n    We look for the following potential values in the `data-mg-theme` attribute:\n\n      - `light` | `dark`\n      - `lowContrast`\n\n    Our LESS mixins (`#mg.darkTheme`, `#mg.lightTheme`, and `#mg.lowContrast`)\n    leverage these values to apply theme-specific styles. Because the attribute\n    can be checked in any order, any of the following formats are considered\n    valid:\n\n      - `[data-mg-theme~='light'] [data-mg-theme~='lowContrast'] ...`\n      - `[data-mg-theme~='lowContrast'] [data-mg-theme~='light'] ...`\n\n    To get this flexibility, we have to nest the `data-mg-theme` attribute\n    at least twice!\n\n   */\n\n  const attributes = {\n    'data-mg-theme': themeMetadata,\n  };\n\n  return (\n    <ThemeContext.Provider value={themeCtx}>\n      <MediaProvider>\n        <Announcer>\n          <div {...attributes}>\n            <div {...attributes} style={themeVariablesMemoized as any}>\n              {children}\n            </div>\n          </div>\n        </Announcer>\n      </MediaProvider>\n    </ThemeContext.Provider>\n  );\n};\n\nThemeProvider.displayName = 'ThemeProvider';\n"],"names":["DEFAULT_THEME","useContext","ThemeContext","getThemeVariables","useIsomorphicLayoutEffect","useMemo","clsx","React","MediaProvider","Announcer"],"mappings":";;;;;;;;;;;;;;;;;;AAca,MAAA,aAAa,GAAiC,CAAC,KAAK,KAAI;IACnE,MAAM,EAAE,KAAK,GAAGA,0BAAa,EAAE,QAAQ,EAAE,GAAG,KAAK,CAAC;IAClD,MAAM,MAAM,GAAG,CAACC,gBAAU,CAACC,qBAAY,CAAC,CAAC,KAAK,CAAC;IAC/C,MAAM,EAAE,SAAS,EAAE,eAAe,EAAE,GAAGC,gCAAiB,CAAC,KAAK,CAAC,CAAC;IAEhEC,mDAAyB,CAAC,MAAK;AAC7B,QAAA,IAAI,MAAM;AAAE,YAAA,eAAe,EAAE,CAAC;KAC/B,EAAE,CAAC,KAAK,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC,CAAC;AAExB,IAAA,MAAM,sBAAsB,GAAGC,aAAO,CAAC,MAAM,SAAS,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC;IACrE,MAAM,aAAa,GAAGC,wBAAI,CAAC,CAAC,KAAK,CAAC,WAAW,GAAG,MAAM,GAAG,OAAO,EAAE,KAAK,CAAC,aAAa,IAAI,aAAa,CAAC,CAAC,CAAC;AACzG,IAAA,MAAM,QAAQ,GAAiBD,aAAO,CAAC,OAAO,EAAE,KAAK,EAAE,CAAC,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC;AAEvE;;;;;;;;;;;;;;;;;;;;;AAqBG;AAEH,IAAA,MAAM,UAAU,GAAG;AACjB,QAAA,eAAe,EAAE,aAAa;KAC/B,CAAC;IAEF,QACEE,wCAACL,qBAAY,CAAC,QAAQ,EAAC,EAAA,KAAK,EAAE,QAAQ,EAAA;AACpC,QAAAK,yBAAA,CAAA,aAAA,CAACC,2BAAa,EAAA,IAAA;AACZ,YAAAD,yBAAA,CAAA,aAAA,CAACE,mBAAS,EAAA,IAAA;AACR,gBAAAF,yBAAA,CAAA,aAAA,CAAA,KAAA,EAAA,MAAA,CAAA,MAAA,CAAA,EAAA,EAAS,UAAU,CAAA;AACjB,oBAAAA,yBAAA,CAAA,aAAA,CAAA,KAAA,EAAA,MAAA,CAAA,MAAA,CAAA,EAAA,EAAS,UAAU,EAAA,EAAE,KAAK,EAAE,sBAA6B,EAAA,CAAA,EACtD,QAAQ,CACL,CACF,CACI,CACE,CACM,EACxB;AACJ,EAAE;AAEF,aAAa,CAAC,WAAW,GAAG,eAAe;;;;"}