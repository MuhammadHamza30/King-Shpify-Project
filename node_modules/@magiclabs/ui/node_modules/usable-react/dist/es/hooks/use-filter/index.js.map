{"version":3,"file":"index.js","sources":["../../../../src/hooks/use-filter/index.ts"],"sourcesContent":["import Fuse from 'fuse.js';\nimport { useState } from 'react';\nimport { useHash } from '../use-hash';\nimport { useDebouncedEffect } from '../use-debounced-effect';\n\ninterface UseFilterOptions<TData> {\n  /**\n   * The search term that will be used to query the `haystack`.\n   */\n  needle?: string;\n\n  /**\n   * The data to search.\n   */\n  haystack?: TData[];\n\n  /**\n   * Debounces the (perhaps costly) fuzzy search operation. Use this option if\n   * performance is a concern.\n   */\n  debounce?: number;\n\n  /**\n   * Fuse.js options -> see https://fusejs.io/\n   */\n  searchOptions?: Fuse.IFuseOptions<TData>;\n}\n\n/**\n * Peform a fuzzy search on a dataset (`haystack`), returning the results that\n * match most closely to the given `needle`.\n */\nexport function useFilter<TData = any>({ needle, haystack, debounce, searchOptions }: UseFilterOptions<TData> = {}) {\n  const [results, setResults] = useState<TData[]>([]);\n\n  const options: Fuse.IFuseOptions<TData> = {\n    keys: [],\n    ...searchOptions,\n  };\n\n  const haystackHash = useHash(haystack);\n  const optionsHash = useHash(options);\n\n  // Execute a search if the needle/haystack changes.\n  useDebouncedEffect(\n    () => {\n      if (needle) {\n        const fuse = new Fuse<TData>(haystack || [], options);\n        if (needle) setResults(fuse.search(needle).map((i) => i.item));\n      }\n    },\n    debounce,\n    [needle, haystackHash, optionsHash],\n  );\n\n  return results;\n}\n"],"names":[],"mappings":";;;;;;AA4BA;;;;SAIgB,SAAS,CAAc,EAA2E;QAA3E,qBAAyE,EAAE,KAAA,EAAzE,MAAM,YAAA,EAAE,QAAQ,cAAA,EAAE,QAAQ,cAAA,EAAE,aAAa,mBAAA;IAC1E,IAAA,KAAA,OAAwB,QAAQ,CAAU,EAAE,CAAC,IAAA,EAA5C,OAAO,QAAA,EAAE,UAAU,QAAyB,CAAC;IAEpD,IAAM,OAAO,cACX,IAAI,EAAE,EAAE,IACL,aAAa,CACjB,CAAC;IAEF,IAAM,YAAY,GAAG,OAAO,CAAC,QAAQ,CAAC,CAAC;IACvC,IAAM,WAAW,GAAG,OAAO,CAAC,OAAO,CAAC,CAAC;;IAGrC,kBAAkB,CAChB;QACE,IAAI,MAAM,EAAE;YACV,IAAM,IAAI,GAAG,IAAI,IAAI,CAAQ,QAAQ,IAAI,EAAE,EAAE,OAAO,CAAC,CAAC;YACtD,IAAI,MAAM;gBAAE,UAAU,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,GAAG,CAAC,UAAC,CAAC,IAAK,OAAA,CAAC,CAAC,IAAI,GAAA,CAAC,CAAC,CAAC;SAChE;KACF,EACD,QAAQ,EACR,CAAC,MAAM,EAAE,YAAY,EAAE,WAAW,CAAC,CACpC,CAAC;IAEF,OAAO,OAAO,CAAC;AACjB;;;;"}