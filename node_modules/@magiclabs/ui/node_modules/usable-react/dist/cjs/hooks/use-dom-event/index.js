'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var _tslib = require('../../_virtual/_tslib.js');
var React = require('react');
var instanceOf = require('../../utils/instance-of.js');

/* eslint-disable no-shadow */
/**
 * Creates a React hook that registers DOM event listeners on the given
 * `element`. The effect returns a `void` function that can be used to remove
 * the event listener manually. Event listeners created this way are
 * automatically cleaned up before the component unmounts.
 */
function useDomEvent(element) {
    return (function () {
        var eventListenerParams = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            eventListenerParams[_i] = arguments[_i];
        }
        var _a = _tslib.__read(eventListenerParams, 4), eventName = _a[0], listener = _a[1], depsOrOptions = _a[2], optionsOrDeps = _a[3];
        var deps = (Array.isArray(depsOrOptions) ? depsOrOptions : optionsOrDeps) || [];
        var options = Array.isArray(depsOrOptions)
            ? optionsOrDeps
            : depsOrOptions;
        var savedListener = React.useRef(listener);
        var savedOptions = React.useRef(options);
        var removeListenerRef = React.useRef(function () { });
        React.useEffect(function () {
            savedListener.current = listener;
        }, [listener]);
        React.useEffect(function () {
            savedOptions.current = options;
        }, [options]);
        React.useEffect(function () {
            // Bail out early if `element` is null.
            if (!element)
                return undefined;
            // Handle events from an `element` given as a valid node.
            if (instanceOf.isWindow(element) || instanceOf.isDocument(element) || instanceOf.isElement(element)) {
                var listener_1 = function (e) { return savedListener.current(e); };
                element.addEventListener(eventName, listener_1, savedOptions.current);
                removeListenerRef.current = function () {
                    element.removeEventListener(eventName, listener_1, savedOptions.current);
                };
                return removeListenerRef.current;
            }
            // Handle events from an `element` given as a React ref.
            if (instanceOf.isRefObject(element)) {
                if (!!element.current && instanceOf.isElement(element.current)) {
                    var listener_2 = function (e) { return savedListener.current(e); };
                    element.current.addEventListener(eventName, listener_2, savedOptions.current);
                    removeListenerRef.current = function () {
                        element.current.removeEventListener(eventName, listener_2, savedOptions.current);
                    };
                    return removeListenerRef.current;
                }
            }
            return undefined;
        }, _tslib.__spread([eventName, element], deps));
        return React.useCallback(function () { return removeListenerRef.current(); }, []);
    });
}

exports.useDomEvent = useDomEvent;
//# sourceMappingURL=index.js.map
